services:
  nginx:
    image: "{{ secrets.DOCKER_USERNAME }}/multi-nginx"
    mem_limit: 128m
    # Can omit hostname since nginx does not have a server in the ./nginx/default.conf
    ports:
      - "80:80"
  server:
    image: "{{ secrets.DOCKER_USERNAME }}/multi-server"
    mem_limit: 128m
    hostname: api # Comes from ./nginx/default.conf
    environment: # Keys found in server/keys.js.
      - REDIS_HOST=redis # References the redis service in the compose file.
      - REDIS_PORT=6379 # From redis documentation.
      - PGUSER=postgres # From postgres documentation.
      - PGHOST=postgres # References postgres service in compose file.
      - PGDATABASE=postgres # From postgres documentation.
      - PGPASSWORD=penguin # References postgres environment password in compose file.
      - PGPORT=5432 # From postgres documentation.
  client:
    image: "{{ secrets.DOCKER_USERNAME }}/multi-client"
    mem_limit: 128m
    hostname: client # Comes from ./nginx/default.conf
  worker:
    image: "{{ secrets.DOCKER_USERNAME }}/multi-worker"
    mem_limit: 128m
    # Can omit hostname since nginx does not have a server in the ./nginx/default.conf
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379





